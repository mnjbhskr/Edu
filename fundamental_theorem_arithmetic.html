<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fundamental Theorem of Arithmetic</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{background:#0a0a1a;color:#e0e0e0;font-family:Georgia,'Times New Roman',serif;line-height:1.6}
        .container{max-width:960px;margin:0 auto;padding:24px 28px 48px}
        .back{color:#606078;text-decoration:none;font-size:0.85em}
        .back:hover{color:#fbbf24}
        h1{font-size:1.8em;font-weight:400;color:#fff;margin:16px 0 4px}
        .subtitle{color:#808098;font-style:italic;margin-bottom:28px}
        h2{font-size:1.15em;font-weight:400;color:#fbbf24;margin-bottom:12px}

        .concept{background:rgba(255,255,255,0.025);border:1px solid rgba(255,255,255,0.06);border-left:3px solid #fbbf24;border-radius:10px;padding:18px 24px;margin-bottom:28px;color:#a0a0b8;font-size:0.93em;line-height:1.75}

        .input-area{text-align:center;margin-bottom:24px}
        .input-area input[type="number"]{background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.12);color:#e0e0e0;font-family:Georgia,serif;font-size:1.1em;padding:8px 14px;border-radius:8px;width:120px;text-align:center}
        .input-area input[type="number"]:focus{outline:none;border-color:#fbbf24}
        .factor-btn{background:rgba(251,191,36,0.12);border:1px solid rgba(251,191,36,0.35);color:#fbbf24;padding:8px 20px;border-radius:8px;cursor:pointer;font-family:Georgia,serif;font-size:0.95em;margin-left:8px;transition:all 0.2s}
        .factor-btn:hover{background:rgba(251,191,36,0.22)}

        .slider-row{margin:12px 0;display:flex;align-items:center;justify-content:center;gap:12px}
        .slider-row input[type="range"]{width:320px;accent-color:#fbbf24}
        .slider-val{color:#808098;font-size:0.85em;min-width:30px}

        .presets{display:flex;gap:8px;flex-wrap:wrap;justify-content:center;margin-top:12px}
        .preset{background:rgba(255,255,255,0.035);border:1px solid rgba(255,255,255,0.07);color:#b0b0c4;padding:4px 12px;border-radius:6px;cursor:pointer;font-family:Georgia,serif;font-size:0.88em;transition:all 0.2s}
        .preset:hover{background:rgba(255,255,255,0.07);color:#e0e0ef}
        .preset.active{background:rgba(251,191,36,0.13);border-color:rgba(251,191,36,0.4);color:#fbbf24}

        .tree-section{background:rgba(255,255,255,0.025);border:1px solid rgba(255,255,255,0.06);border-radius:10px;padding:20px;margin-bottom:24px;text-align:center}
        canvas{display:block;margin:0 auto;border-radius:10px}

        .canon{font-size:1.15em;margin:14px 0 4px;color:#e0e0e0;letter-spacing:0.5px}
        .canon sup{font-size:0.7em;color:#fbbf24}
        .prime-msg{color:#fbbf24;font-style:italic;font-size:0.93em;margin-top:8px}
        .path-info{color:#808098;font-size:0.82em;margin-top:6px}

        .blocks-row{display:flex;gap:4px;justify-content:center;margin:14px 0 6px;flex-wrap:wrap}
        .pblock{padding:5px 12px;border-radius:5px;font-size:0.92em;font-weight:600;color:#0a0a1a;min-width:28px;text-align:center}

        .path-btn{background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.09);color:#b0b0c4;padding:6px 16px;border-radius:7px;cursor:pointer;font-family:Georgia,serif;font-size:0.88em;margin-top:10px;transition:all 0.2s}
        .path-btn:hover{background:rgba(255,255,255,0.08);color:#fbbf24}

        .gcd-section{background:rgba(255,255,255,0.025);border:1px solid rgba(255,255,255,0.06);border-radius:10px;padding:20px 24px;margin-bottom:24px}
        .gcd-inputs{display:flex;gap:12px;align-items:center;justify-content:center;margin:12px 0 16px;flex-wrap:wrap}
        .gcd-inputs input{background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.12);color:#e0e0e0;font-family:Georgia,serif;font-size:1em;padding:7px 12px;border-radius:8px;width:100px;text-align:center}
        .gcd-inputs input:focus{outline:none;border-color:#fbbf24}
        .gcd-result{display:flex;gap:28px;justify-content:center;flex-wrap:wrap;margin-top:12px}
        .gcd-card{background:rgba(255,255,255,0.025);border:1px solid rgba(255,255,255,0.06);border-radius:8px;padding:14px 20px;min-width:200px;text-align:center}
        .gcd-card h4{font-weight:400;font-size:0.78em;color:#808098;text-transform:uppercase;letter-spacing:1px;margin-bottom:8px}
        .gcd-factors{font-size:0.95em;margin-bottom:6px;line-height:1.8}
        .gcd-val{font-size:1.3em;color:#fbbf24}
        .gcd-shared{background:rgba(251,191,36,0.1);border-radius:4px;padding:0 4px}
        .gcd-max{background:rgba(251,191,36,0.06);border:1px dashed rgba(251,191,36,0.3);border-radius:4px;padding:0 4px}

        .insight{background:rgba(255,255,255,0.025);border:1px solid rgba(255,255,255,0.06);border-radius:10px;padding:20px 24px}
        .insight-title{color:#fbbf24;font-size:1.05em;margin-bottom:6px}
        .insight-text{color:#a0a0b8;font-size:0.9em;line-height:1.75}
    </style>
</head>
<body>
<div class="container">
    <a class="back" href="index.html">&larr; Back to Index</a>
    <h1>Fundamental Theorem of Arithmetic</h1>
    <p class="subtitle">Every integer is a unique product of primes &mdash; factor trees in action</p>

    <div class="concept">Every integer greater than 1 can be written as a product of prime numbers, and this representation is unique (up to the order of factors). This is why primes are called the &lsquo;atoms&rsquo; of arithmetic &mdash; they are the indivisible building blocks from which all numbers are constructed.</div>

    <div class="input-area">
        <input type="number" id="numInput" min="2" max="9999" value="60">
        <button class="factor-btn" onclick="factorNumber()">Factor</button>
        <div class="slider-row">
            <span class="slider-val">2</span>
            <input type="range" id="slider" min="2" max="500" value="60">
            <span class="slider-val">500</span>
        </div>
        <div class="presets" id="presets"></div>
    </div>

    <div class="tree-section">
        <canvas id="treeCanvas" width="700" height="400"></canvas>
        <div class="canon" id="canonForm"></div>
        <div class="prime-msg" id="primeMsg"></div>
        <div class="blocks-row" id="blocks"></div>
        <div class="path-info" id="pathInfo"></div>
        <button class="path-btn" id="pathBtn" onclick="nextPath()">Show Different Factorization Path</button>
    </div>

    <div class="gcd-section">
        <h2>Prime Factorization Reveals GCD and LCM</h2>
        <div class="gcd-inputs">
            <input type="number" id="gcdA" min="2" max="9999" value="12" placeholder="A">
            <span style="color:#808098">and</span>
            <input type="number" id="gcdB" min="2" max="9999" value="18" placeholder="B">
            <button class="factor-btn" onclick="computeGcdLcm()">Compute</button>
        </div>
        <div class="gcd-result" id="gcdResult"></div>
    </div>

    <div class="insight">
        <div class="insight-title" id="insightTitle">Why Uniqueness Matters</div>
        <div class="insight-text" id="insightText">The Fundamental Theorem of Arithmetic, first proved rigorously by Gauss in 1801, establishes that prime factorization is unique. This uniqueness is not obvious &mdash; it fails in some other number systems! It is the foundation of number theory and modern cryptography.</div>
    </div>
</div>

<script>
const PRIME_COLORS = {2:'#e74c3c',3:'#3b82f6',5:'#2ecc71',7:'#f97316',11:'#a855f7',13:'#ec4899'};
const DEFAULT_PRIME = '#fbbf24';
function primeColor(p){ return PRIME_COLORS[p] || DEFAULT_PRIME; }

const PRESETS = [
    {n:12, label:'12'}, {n:60, label:'60'}, {n:97, label:'97'},
    {n:360, label:'360'}, {n:1024, label:'1024'}, {n:2310, label:'2310'}, {n:100, label:'100'}
];

let currentNumber = 60, currentPathIdx = 0, allPaths = [], animTimer = null;

/* --- Prime factorization (trial division) --- */
function primeFactors(n){
    const fs = [];
    for(let d=2; d*d<=n; d++) while(n%d===0){ fs.push(d); n/=d; }
    if(n>1) fs.push(n);
    return fs;
}
function isPrime(n){ if(n<2) return false; for(let d=2;d*d<=n;d++) if(n%d===0) return false; return true; }

/* --- Find all distinct first-split factor pairs --- */
function factorPairs(n){
    const pairs = [];
    for(let d=2; d<=Math.sqrt(n); d++){
        if(n%d===0) pairs.push([d, n/d]);
    }
    return pairs;
}

/* --- Build a factor tree given an initial split strategy --- */
function buildTree(n, pickSplit){
    if(isPrime(n) || n <= 1) return {val:n, prime:true, children:null};
    const pair = pickSplit(n);
    if(!pair) return {val:n, prime:true, children:null};
    return {val:n, prime:false, children:[buildTree(pair[0], pickSplit), buildTree(pair[1], pickSplit)]};
}

/* --- Generate different split strategies --- */
function splitStrategies(n){
    const pairs = factorPairs(n);
    if(pairs.length === 0) return [null];
    const strats = pairs.map(pair => {
        return function picker(m){
            if(m === n) return pair;
            const ps = factorPairs(m);
            return ps.length > 0 ? ps[0] : null;
        };
    });
    /* Also add a "largest first" variant */
    if(pairs.length > 1){
        strats.push(function(m){
            const ps = factorPairs(m);
            return ps.length > 0 ? ps[ps.length-1] : null;
        });
    }
    return strats;
}

/* --- Recursive tree to get all split paths --- */
function allSplitTrees(n){
    const strats = splitStrategies(n);
    const trees = [];
    const seen = new Set();
    for(const s of strats){
        const t = buildTree(n, s);
        const key = treeKey(t);
        if(!seen.has(key)){ seen.add(key); trees.push(t); }
    }
    /* ensure at least the smallest-first tree */
    if(trees.length === 0){
        trees.push(buildTree(n, m => { const ps=factorPairs(m); return ps[0]||null; }));
    }
    return trees;
}
function treeKey(t){
    if(!t.children) return String(t.val);
    return t.val+'('+treeKey(t.children[0])+','+treeKey(t.children[1])+')';
}

/* --- Layout tree positions --- */
function layoutTree(tree, cx, cy, levelH, spread, depth){
    tree.x = cx; tree.y = cy; tree.depth = depth;
    if(!tree.children) return;
    const off = spread / Math.pow(1.8, depth);
    layoutTree(tree.children[0], cx - off, cy + levelH, levelH, spread, depth+1);
    layoutTree(tree.children[1], cx + off, cy + levelH, levelH, spread, depth+1);
}

function treeDepth(t){ return t.children ? 1+Math.max(treeDepth(t.children[0]),treeDepth(t.children[1])) : 0; }

/* --- Canvas drawing with animation --- */
const cvs = document.getElementById('treeCanvas'), ctx = cvs.getContext('2d');
const CW = cvs.width, CH = cvs.height;

function collectNodes(t, list){
    list = list || [];
    list.push(t);
    if(t.children){ collectNodes(t.children[0],list); collectNodes(t.children[1],list); }
    return list;
}

let animNodes = [], animStep = 0, animDone = false;

function animateTree(tree){
    if(animTimer) cancelAnimationFrame(animTimer);
    const d = treeDepth(tree);
    const levelH = Math.min(80, (CH-80)/(d||1));
    const spread = Math.min(280, CW*0.38);
    layoutTree(tree, CW/2, 38, levelH, spread, 0);
    animNodes = collectNodes(tree);
    /* sort by depth so parents appear first */
    animNodes.sort((a,b) => a.depth - b.depth);
    animStep = 0; animDone = false;
    let lastTime = 0;
    const INTERVAL = 350;
    function frame(ts){
        if(!lastTime) lastTime = ts;
        if(ts - lastTime > INTERVAL && animStep < animNodes.length){
            animStep++; lastTime = ts;
        }
        drawFrame(tree, animStep);
        if(animStep < animNodes.length) animTimer = requestAnimationFrame(frame);
        else animDone = true;
    }
    animTimer = requestAnimationFrame(frame);
}

function drawFrame(tree, showCount){
    ctx.clearRect(0,0,CW,CH);
    ctx.fillStyle = '#0a0a1a'; ctx.fillRect(0,0,CW,CH);
    const visible = new Set(animNodes.slice(0, showCount));
    drawEdges(tree, visible);
    drawNodes(tree, visible);
}

function drawEdges(t, visible){
    if(!t.children || !visible.has(t)) return;
    for(const c of t.children){
        if(!visible.has(c)) continue;
        ctx.beginPath();
        ctx.moveTo(t.x, t.y+18);
        ctx.lineTo(c.x, c.y-18);
        ctx.strokeStyle = 'rgba(255,255,255,0.12)';
        ctx.lineWidth = 1.5;
        ctx.stroke();
        drawEdges(c, visible);
    }
}

function drawNodes(t, visible){
    if(!visible.has(t)) return;
    const r = t.prime ? 20 : 22;
    const col = t.prime ? primeColor(t.val) : '#fbbf24';

    if(t.prime){
        ctx.shadowColor = col; ctx.shadowBlur = 14;
    }
    ctx.beginPath(); ctx.arc(t.x, t.y, r, 0, Math.PI*2);
    ctx.fillStyle = t.prime ? col+'22' : 'rgba(255,255,255,0.04)';
    ctx.fill();
    ctx.strokeStyle = col;
    ctx.lineWidth = t.prime ? 2 : 1.2;
    ctx.stroke();
    ctx.shadowBlur = 0;

    ctx.fillStyle = t.prime ? col : '#e0e0e0';
    ctx.font = (t.val > 999 ? '12' : t.val > 99 ? '14' : '16') + 'px Georgia';
    ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
    ctx.fillText(t.val, t.x, t.y);

    if(t.children){
        for(const c of t.children) drawNodes(c, visible);
    }
}

/* --- Canonical form display --- */
function showCanonical(n){
    const fs = primeFactors(n);
    const pm = document.getElementById('primeMsg');
    const cf = document.getElementById('canonForm');
    const bl = document.getElementById('blocks');
    const pb = document.getElementById('pathBtn');

    if(isPrime(n)){
        cf.innerHTML = '';
        pm.textContent = n + ' is prime \u2014 it cannot be factored further. It IS an atom of arithmetic.';
        bl.innerHTML = '';
        pb.style.display = 'none';
        updateInsight('prime');
        return;
    }
    pm.textContent = '';
    pb.style.display = '';

    /* Build canonical form string */
    const counts = {};
    fs.forEach(f => counts[f] = (counts[f]||0)+1);
    const primes = Object.keys(counts).map(Number).sort((a,b)=>a-b);
    let html = n + ' = ';
    html += primes.map(p => {
        const c = counts[p];
        const col = primeColor(p);
        return '<span style="color:'+col+'">'+p+(c>1?'<sup>'+c+'</sup>':'')+'</span>';
    }).join(' &times; ');
    cf.innerHTML = html;

    /* Building blocks */
    let bhtml = '';
    fs.sort((a,b)=>a-b);
    fs.forEach(f => {
        bhtml += '<div class="pblock" style="background:'+primeColor(f)+'">'+f+'</div>';
    });
    bl.innerHTML = bhtml;

    updateInsight('normal');
}

/* --- Path switching --- */
function nextPath(){
    if(allPaths.length <= 1) return;
    currentPathIdx = (currentPathIdx + 1) % allPaths.length;
    animateTree(allPaths[currentPathIdx]);
    document.getElementById('pathInfo').textContent =
        'Path ' + (currentPathIdx+1) + ' of ' + allPaths.length +
        ' \u2014 Different trees, same prime leaves \u2014 that\u2019s the theorem!';
    updateInsight('path');
}

function updateInsight(mode){
    const t = document.getElementById('insightTitle');
    const x = document.getElementById('insightText');
    if(mode === 'prime'){
        t.textContent = 'Primes Are Irreducible';
        x.textContent = 'Prime numbers cannot be broken down further. They are the atoms from which all other numbers are built. Every composite number decomposes into primes, but primes themselves are the endpoint of factorization.';
    } else if(mode === 'path'){
        t.textContent = 'Uniqueness in Action';
        x.textContent = 'No matter how you split the number, you always arrive at the same set of prime factors. The tree may differ, but the leaves are invariant. This is the essence of the Fundamental Theorem of Arithmetic.';
    } else {
        t.textContent = 'Why Uniqueness Matters';
        x.textContent = 'The Fundamental Theorem of Arithmetic, first proved rigorously by Gauss in 1801, establishes that prime factorization is unique. This uniqueness is not obvious \u2014 it fails in some other number systems! It is the foundation of number theory and modern cryptography.';
    }
}

/* --- Main entry point --- */
function factorNumber(){
    let n = parseInt(document.getElementById('numInput').value);
    if(isNaN(n) || n < 2) n = 2;
    if(n > 9999) n = 9999;
    document.getElementById('numInput').value = n;
    document.getElementById('slider').value = Math.min(500, n);
    currentNumber = n;
    currentPathIdx = 0;
    allPaths = allSplitTrees(n);
    animateTree(allPaths[0]);
    showCanonical(n);
    document.getElementById('pathInfo').textContent =
        allPaths.length > 1 ? allPaths.length + ' distinct factorization paths available' : '';
    highlightPreset(n);
}

/* --- Presets --- */
function renderPresets(){
    const c = document.getElementById('presets');
    c.innerHTML = PRESETS.map(p =>
        '<button class="preset" data-n="'+p.n+'" onclick="selectPreset('+p.n+')">'+p.label+'</button>'
    ).join('');
}
function selectPreset(n){
    document.getElementById('numInput').value = n;
    factorNumber();
}
function highlightPreset(n){
    document.querySelectorAll('.preset').forEach(b => {
        b.classList.toggle('active', parseInt(b.dataset.n) === n);
    });
}

/* --- Slider --- */
document.getElementById('slider').addEventListener('input', function(){
    document.getElementById('numInput').value = this.value;
    factorNumber();
});
document.getElementById('numInput').addEventListener('keydown', function(e){
    if(e.key === 'Enter') factorNumber();
});

/* --- GCD / LCM --- */
function computeGcdLcm(){
    let a = parseInt(document.getElementById('gcdA').value);
    let b = parseInt(document.getElementById('gcdB').value);
    if(isNaN(a)||a<2) a=2; if(isNaN(b)||b<2) b=2;
    if(a>9999) a=9999; if(b>9999) b=9999;
    document.getElementById('gcdA').value = a;
    document.getElementById('gcdB').value = b;

    const fa = primeFactors(a), fb = primeFactors(b);
    const ca = {}, cb = {};
    fa.forEach(f => ca[f]=(ca[f]||0)+1);
    fb.forEach(f => cb[f]=(cb[f]||0)+1);
    const allP = [...new Set([...Object.keys(ca),...Object.keys(cb)])].map(Number).sort((x,y)=>x-y);

    /* GCD = min powers, LCM = max powers */
    let gcd = 1, lcm = 1;
    const gcdParts = [], lcmParts = [];
    allP.forEach(p => {
        const pa = ca[p]||0, pb = cb[p]||0;
        const mn = Math.min(pa,pb), mx = Math.max(pa,pb);
        if(mn > 0){ gcd *= Math.pow(p,mn); gcdParts.push({p,e:mn}); }
        lcm *= Math.pow(p,mx); lcmParts.push({p,e:mx});
    });

    function fmtFactors(parts){
        return parts.map(({p,e}) => {
            const col = primeColor(p);
            return '<span style="color:'+col+'">'+p+(e>1?'<sup>'+e+'</sup>':'')+'</span>';
        }).join(' &times; ');
    }
    function fmtLine(n, counts, allPrimes, mode){
        return allPrimes.map(p => {
            const e = counts[p]||0;
            if(e===0) return '';
            const col = primeColor(p);
            const isShared = (ca[p]||0)>0 && (cb[p]||0)>0;
            const cls = isShared ? (mode==='gcd'?'gcd-shared':'gcd-max') : '';
            return '<span class="'+cls+'" style="color:'+col+'">'+p+(e>1?'<sup>'+e+'</sup>':'')+'</span>';
        }).filter(Boolean).join(' &times; ');
    }

    let html = '';
    /* Factorizations side by side */
    html += '<div class="gcd-card"><h4>Factorizations</h4>';
    html += '<div class="gcd-factors">'+a+' = '+fmtLine(a,ca,allP,'')+'</div>';
    html += '<div class="gcd-factors">'+b+' = '+fmtLine(b,cb,allP,'')+'</div></div>';
    /* GCD */
    html += '<div class="gcd-card"><h4>GCD (min powers)</h4>';
    if(gcdParts.length > 0){
        html += '<div class="gcd-factors">'+fmtFactors(gcdParts)+'</div>';
    } else {
        html += '<div class="gcd-factors" style="color:#808098">no common factors</div>';
    }
    html += '<div class="gcd-val">'+gcd+'</div></div>';
    /* LCM */
    html += '<div class="gcd-card"><h4>LCM (max powers)</h4>';
    html += '<div class="gcd-factors">'+fmtFactors(lcmParts)+'</div>';
    html += '<div class="gcd-val">'+lcm+'</div></div>';

    document.getElementById('gcdResult').innerHTML = html;
}

/* --- Init --- */
renderPresets();
factorNumber();
computeGcdLcm();
</script>
<footer style="text-align:center;padding:28px 20px 18px;color:#505068;font-size:0.72em;line-height:1.7;border-top:1px solid rgba(255,255,255,0.04);margin-top:30px"><div>&copy; 2025&ndash;2026 Manoj Bhaskar &middot; Coded by <a href="https://claude.ai/claude-code" style="color:#606078;text-decoration:none" target="_blank" rel="noopener">Claude</a> &middot; <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" style="color:#606078;text-decoration:none" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a></div></footer>
</body>
</html>
